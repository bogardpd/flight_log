<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: AeroAPI4
  
    &mdash; Documentation by YARD 0.9.27
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "AeroAPI4";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (A)</a> &raquo;
    
    
    <span class="title">AeroAPI4</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: AeroAPI4
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/modules/aero_api4.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Provides utilities for interacting with with FlightAware AeroAPI (version 4).</p>

<p>This is used to look up <span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span> data that couldn’t be found from a <span class='object_link'><a href="BoardingPass.html" title="BoardingPass (class)">BoardingPass</a></span> or <span class='object_link'><a href="PKPass.html" title="PKPass (class)">PKPass</a></span> for the purposes of prepopulating the <span class='object_link'><a href="FlightsController.html#new-instance_method" title="FlightsController#new (method)">new flight</a></span> form. It’s also used to look up <span class='object_link'><a href="Airport.html" title="Airport (class)">Airport</a></span> data when creating a <span class='object_link'><a href="AirportsController.html#new-instance_method" title="AirportsController#new (method)">new airport</a></span>.</p>

<p>Note: Since AeroAPI has its own database of flights, airports, and routes, when you see these terms in this documentation, it refers to AeroAPI and not this applications models, unless it specifically links to <span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span>, <span class='object_link'><a href="Airport.html" title="Airport (class)">Airport</a></span>, or <span class='object_link'><a href="Route.html" title="Route (class)">Route</a></span>.</p>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://flightaware.com/commercial/aeroapi/" target="_parent" title="https://flightaware.com/commercial/aeroapi/">https://flightaware.com/commercial/aeroapi/</a></li>
    
      <li><a href="https://flightaware.com/aeroapi/portal/documentation" target="_parent" title="https://flightaware.com/aeroapi/portal/documentation">https://flightaware.com/aeroapi/portal/documentation</a></li>
    
  </ul>

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="API_SERVER-constant" class="">API_SERVER =
          <div class="docstring">
  <div class="discussion">
    
<p>Location of AeroAPI’s API server.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https://aeroapi.flightaware.com/aeroapi</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
        <dt id="ERROR-constant" class="">ERROR =
          <div class="docstring">
  <div class="discussion">
    
<p>The default error message to return if an AeroAPI lookup failed.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>We couldn’t find your flight data on FlightAware. You will have to manually enter some fields.</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#airport_coordinates-class_method" title="airport_coordinates (class method)">.<strong>airport_coordinates</strong>(airport_icao)  &#x21d2; Array&lt;Float&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Looks up the latitude and longitude for an ICAO airport code.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#airport_lookup-class_method" title="airport_lookup (class method)">.<strong>airport_lookup</strong>(airport_icao)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Looks up airport info for an ICAO airport code.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#api_request-class_method" title="api_request (class method)">.<strong>api_request</strong>(path)  &#x21d2; Dict </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Passes paths to AeroAPI and gets a hash of results.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#arrival_time-class_method" title="arrival_time (class method)">.<strong>arrival_time</strong>(flight_hash)  &#x21d2; Time </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the best arrival time from provided flight data.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#departure_time-class_method" title="departure_time (class method)">.<strong>departure_time</strong>(flight_hash)  &#x21d2; Time </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the best departure time from provided flight data.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#flight_lookup-class_method" title="flight_lookup (class method)">.<strong>flight_lookup</strong>(ident)  &#x21d2; Array&lt;Hash&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Looks up flight data for flights matching a flight identifier string.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#form_values-class_method" title="form_values (class method)">.<strong>form_values</strong>(fa_flight_id)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Looks up flight data for an AeroAPI fa_flight_id.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_flight_id-class_method" title="get_flight_id (class method)">.<strong>get_flight_id</strong>(ident, scheduled_out_utc)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Looks up an AeroAPI unique flight ID for flights matching a flight identifier string and UTC departure datetime.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="airport_coordinates-class_method">
  
    .<strong>airport_coordinates</strong>(airport_icao)  &#x21d2; <tt>Array&lt;Float&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Looks up the latitude and longitude for an ICAO airport code.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>airport_icao</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an ICAO airport code</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Float&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>latitude and longitude in decimal degrees</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


42
43
44
45
46
47
48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/modules/aero_api4.rb', line 42</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_airport_coordinates'>airport_coordinates</span><span class='lparen'>(</span><span class='id identifier rubyid_airport_icao'>airport_icao</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='id identifier rubyid_api_request'>api_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/airports/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_airport_icao'>airport_icao</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='lparen'>(</span><span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:latitude</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:longitude</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:latitude</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span><span class='comma'>,</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:longitude</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span><span class='rbracket'>]</span>
  <span class='kw'>rescue</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="airport_lookup-class_method">
  
    .<strong>airport_lookup</strong>(airport_icao)  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Looks up airport info for an ICAO airport code.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>airport_icao</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an ICAO airport code</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a hash of airport details</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


56
57
58
59
60
61
62
63
64
65
66
67
68
69
70</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/modules/aero_api4.rb', line 56</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_airport_lookup'>airport_lookup</span><span class='lparen'>(</span><span class='id identifier rubyid_airport_icao'>airport_icao</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='id identifier rubyid_api_request'>api_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/airports/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_airport_icao'>airport_icao</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:timezone</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>timezone:</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:timezone</span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='label'>display_code:</span> <span class='lparen'>(</span><span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:alternate_ident</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_airport_icao'>airport_icao</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='label'>city:</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:city</span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='label'>name:</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='rbrace'>}</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_output'>output</span>
  <span class='kw'>rescue</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="api_request-class_method">
  
    .<strong>api_request</strong>(path)  &#x21d2; <tt>Dict</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Passes paths to AeroAPI and gets a hash of results.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an AeroAPI path, not including the server.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Dict</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the AeroAPI response</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/modules/aero_api4.rb', line 29</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_api_request'>api_request</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='const'>URI</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="#API_SERVER-constant" title="AeroAPI4::API_SERVER (constant)">API_SERVER</a></span></span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_headers'>headers</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>x-apikey</span><span class='label_end'>&#39;:</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_credentials'>credentials</span><span class='lbracket'>[</span><span class='symbol'>:aeroapi</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:v4</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:api_key</span><span class='rbracket'>]</span>
  <span class='rbrace'>}</span>
  <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='period'>.</span><span class='id identifier rubyid_get_response'>get_response</span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='id identifier rubyid_headers'>headers</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_with_indifferent_access'>with_indifferent_access</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="arrival_time-class_method">
  
    .<strong>arrival_time</strong>(flight_hash)  &#x21d2; <tt>Time</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the best arrival time from provided flight data.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>flight_hash</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an item from a flight_lookup array</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Time</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a UTC timestamp</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/modules/aero_api4.rb', line 180</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arrival_time'>arrival_time</span><span class='lparen'>(</span><span class='id identifier rubyid_flight_hash'>flight_hash</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_times'>times</span> <span class='op'>=</span> <span class='lbracket'>[</span>
    <span class='id identifier rubyid_flight_hash'>flight_hash</span><span class='lbracket'>[</span><span class='symbol'>:scheduled_in</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='id identifier rubyid_flight_hash'>flight_hash</span><span class='lbracket'>[</span><span class='symbol'>:scheduled_on</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='id identifier rubyid_flight_hash'>flight_hash</span><span class='lbracket'>[</span><span class='symbol'>:estimated_in</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='id identifier rubyid_flight_hash'>flight_hash</span><span class='lbracket'>[</span><span class='symbol'>:estimated_on</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='id identifier rubyid_flight_hash'>flight_hash</span><span class='lbracket'>[</span><span class='symbol'>:actual_in</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='id identifier rubyid_flight_hash'>flight_hash</span><span class='lbracket'>[</span><span class='symbol'>:actual_on</span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_times'>times</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
  <span class='kw'>begin</span>
    <span class='kw'>return</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_times'>times</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_utc'>utc</span>
  <span class='kw'>rescue</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="departure_time-class_method">
  
    .<strong>departure_time</strong>(flight_hash)  &#x21d2; <tt>Time</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the best departure time from provided flight data.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>flight_hash</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an item from a flight_lookup array</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Time</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a UTC timestamp</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/modules/aero_api4.rb', line 159</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_departure_time'>departure_time</span><span class='lparen'>(</span><span class='id identifier rubyid_flight_hash'>flight_hash</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_times'>times</span> <span class='op'>=</span> <span class='lbracket'>[</span>
    <span class='id identifier rubyid_flight_hash'>flight_hash</span><span class='lbracket'>[</span><span class='symbol'>:scheduled_out</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='id identifier rubyid_flight_hash'>flight_hash</span><span class='lbracket'>[</span><span class='symbol'>:scheduled_off</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='id identifier rubyid_flight_hash'>flight_hash</span><span class='lbracket'>[</span><span class='symbol'>:estimated_out</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='id identifier rubyid_flight_hash'>flight_hash</span><span class='lbracket'>[</span><span class='symbol'>:estimated_off</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='id identifier rubyid_flight_hash'>flight_hash</span><span class='lbracket'>[</span><span class='symbol'>:actual_out</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='id identifier rubyid_flight_hash'>flight_hash</span><span class='lbracket'>[</span><span class='symbol'>:actual_off</span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_times'>times</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
  <span class='kw'>begin</span>
    <span class='kw'>return</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_times'>times</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_utc'>utc</span>
  <span class='kw'>rescue</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="flight_lookup-class_method">
  
    .<strong>flight_lookup</strong>(ident)  &#x21d2; <tt>Array&lt;Hash&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Looks up flight data for flights matching a flight identifier string.</p>

<p>A flight identifier is a string containing an airline code and a flight number, with no space between them (e.g. AA1234 or UAL5678). The airline can be ICAO or IATA, but IATA codes that contain numbers (e.g. B6) may not be used (the ICAO code must then be used in these cases).</p>

<p>Usually the multiple matching flights are the same flight number on different days, but some airlines reuse a flight number multiple times per day for different routes.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>ident</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a flight identifier</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Hash&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>data for each matching flight</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


85
86
87
88
89
90
91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/modules/aero_api4.rb', line 85</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_flight_lookup'>flight_lookup</span><span class='lparen'>(</span><span class='id identifier rubyid_ident'>ident</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='id identifier rubyid_api_request'>api_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/flights/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ident'>ident</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:flights</span><span class='rbracket'>]</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:flights</span><span class='rbracket'>]</span>
  <span class='kw'>rescue</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="form_values-class_method">
  
    .<strong>form_values</strong>(fa_flight_id)  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Looks up flight data for an AeroAPI fa_flight_id.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>fa_flight_id</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a FlightAware/AeroAPI unique flight ID</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>flight data</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/modules/aero_api4.rb', line 99</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_form_values'>form_values</span><span class='lparen'>(</span><span class='id identifier rubyid_fa_flight_id'>fa_flight_id</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_fa_flight_id'>fa_flight_id</span>
  <span class='id identifier rubyid_fields'>fields</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='id identifier rubyid_api_request'>api_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/flights/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_fa_flight_id'>fa_flight_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:flights</span><span class='rbracket'>]</span> <span class='kw'>and</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:flights</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_flight'>flight</span> <span class='op'>=</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:flights</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>rescue</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
  
  <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='lparen'>(</span><span class='symbol'>:origin_airport_icao</span><span class='comma'>,</span> <span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:origin</span><span class='comma'>,</span> <span class='symbol'>:code</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:origin</span><span class='comma'>,</span> <span class='symbol'>:code</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='lparen'>(</span><span class='symbol'>:destination_airport_icao</span><span class='comma'>,</span> <span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:destination</span><span class='comma'>,</span> <span class='symbol'>:code</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:destination</span><span class='comma'>,</span> <span class='symbol'>:code</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='lparen'>(</span><span class='symbol'>:aircraft_family_icao</span><span class='comma'>,</span> <span class='id identifier rubyid_flight'>flight</span><span class='lbracket'>[</span><span class='symbol'>:aircraft_type</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_flight'>flight</span><span class='lbracket'>[</span><span class='symbol'>:aircraft_type</span><span class='rbracket'>]</span>
  
  <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='lparen'>(</span><span class='symbol'>:operator_icao</span><span class='comma'>,</span> <span class='id identifier rubyid_flight'>flight</span><span class='lbracket'>[</span><span class='symbol'>:operator</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_flight'>flight</span><span class='lbracket'>[</span><span class='symbol'>:operator</span><span class='rbracket'>]</span>
  
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='lparen'>(</span><span class='symbol'>:departure_utc</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_flight'>flight</span><span class='lbracket'>[</span><span class='symbol'>:scheduled_out</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_utc'>utc</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_flight'>flight</span><span class='lbracket'>[</span><span class='symbol'>:scheduled_out</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='lparen'>(</span><span class='symbol'>:tail_number</span><span class='comma'>,</span> <span class='id identifier rubyid_flight'>flight</span><span class='lbracket'>[</span><span class='symbol'>:registration</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_flight'>flight</span><span class='lbracket'>[</span><span class='symbol'>:registration</span><span class='rbracket'>]</span>
  
  <span class='kw'>return</span> <span class='id identifier rubyid_fields'>fields</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_flight_id-class_method">
  
    .<strong>get_flight_id</strong>(ident, scheduled_out_utc)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Looks up an AeroAPI unique flight ID for flights matching a flight identifier string and UTC departure datetime.</p>

<p>A flight identifier is a string containing an airline code and a flight number, with no space between them (e.g. AA1234 or UAL5678). The airline can be ICAO or IATA, but IATA codes that contain numbers (e.g. B6) may not be used (the ICAO code must then be used in these cases).</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>ident</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a flight identifier</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>scheduled_out_utc</span>
      
      
        <span class='type'>(<tt>DateTime</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a UTC departure time</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an AeroAPI fa_flight_id</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/modules/aero_api4.rb', line 136</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_flight_id'>get_flight_id</span><span class='lparen'>(</span><span class='id identifier rubyid_ident'>ident</span><span class='comma'>,</span> <span class='id identifier rubyid_scheduled_out_utc'>scheduled_out_utc</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='id identifier rubyid_api_request'>api_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/flights/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ident'>ident</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:flights</span><span class='rbracket'>]</span>
  <span class='kw'>rescue</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_flight'>flight</span> <span class='op'>=</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='symbol'>:flights</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
    <span class='kw'>begin</span>
      <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_f'>f</span><span class='lbracket'>[</span><span class='symbol'>:scheduled_out</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_scheduled_out_utc'>scheduled_out_utc</span>
    <span class='kw'>rescue</span>
      <span class='kw'>false</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='kw'>nil</span> <span class='op'>:</span> <span class='id identifier rubyid_flight'>flight</span><span class='lbracket'>[</span><span class='symbol'>:fa_flight_id</span><span class='rbracket'>]</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Apr 20 19:26:42 2022 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.27 (ruby-3.1.1).
</div>

    </div>
  </body>
</html>