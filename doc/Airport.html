<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Airport
  
    &mdash; Documentation by YARD 0.9.19
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Airport";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (A)</a> &raquo;
    
    
    <span class="title">Airport</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Airport
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ActiveRecord::Base</li>
          
            <li class="next"><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></li>
          
            <li class="next">Airport</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/models/airport.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Defines a model for airports.</p>


  </div>
</div>
<div class="tags">
  

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="STRIP_ATTRS-constant" class="">STRIP_ATTRS =
          <div class="docstring">
  <div class="discussion">
    
<p>Form fields which should be saved with leading and trailing whitespace
removed.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='qwords_beg'>%w( </span><span class='tstring_content'>city</span><span class='words_sep'> </span><span class='tstring_content'>country</span><span class='words_sep'> )</span></pre></dd>
      
        <dt id="CAP_CODES-constant" class="">CAP_CODES =
          <div class="docstring">
  <div class="discussion">
    
<p>Form fields which should be saved capitalized.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='qwords_beg'>%w( </span><span class='tstring_content'>iata_code</span><span class='words_sep'> </span><span class='tstring_content'>icao_code</span><span class='words_sep'> )</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#convert_iata_to_icao-class_method" title="convert_iata_to_icao (class method)">.<strong>convert_iata_to_icao</strong>(iata, keep_iata = true)  &#x21d2; String<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Accepts an airport IATA code, and returns the matching ICAO code.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#direct_flight_count-class_method" title="direct_flight_count (class method)">.<strong>direct_flight_count</strong>(flights, direct_flight_airport, sort_category = nil, sort_direction = nil)  &#x21d2; Array&lt;Hash&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Given a collection of flights and a direct flight <span class='object_link'><a href="" title="Airport (class)">Airport</a></span>, returns data
about the direct flights to or from the specified airport within the flight
collection.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#in_region_hash-class_method" title="in_region_hash (class method)">.<strong>in_region_hash</strong>(icao_starts)  &#x21d2; Hash&lt;Integer,String&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Take a collection of strings representing the starts of ICAO codes, and
return an a hash of all Airports whose airport ICAO codes start with any of
the provided strings.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#in_region_iata_codes-class_method" title="in_region_iata_codes (class method)">.<strong>in_region_iata_codes</strong>(icao_starts)  &#x21d2; Array&lt;String&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Take a collection of strings representing the starts of ICAO codes, and
return all IATA codes whose airport ICAO codes start with any of the
provided strings.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#in_region_ids-class_method" title="in_region_ids (class method)">.<strong>in_region_ids</strong>(icao_starts)  &#x21d2; Array&lt;String&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Take a collection of strings representing the starts of ICAO codes, and
return all airport IDs whose airport ICAO codes start with any of the
provided strings.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new_in_date_range-class_method" title="new_in_date_range (class method)">.<strong>new_in_date_range</strong>(flyer, current_user, date_range)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Accepts a flyer, the viewing user, and a date range, and returns the IATA
code for all airports that had their first flight in this date range.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#visit_frequencies-class_method" title="visit_frequencies (class method)">.<strong>visit_frequencies</strong>(flights)  &#x21d2; Hash&lt;Integer,Integer&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Take a collection of <span class='object_link'><a href="Flight.html" title="Flight (class)">Flights</a></span>, and return a hash of airport IDs and
number of visits.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#visit_table_data-class_method" title="visit_table_data (class method)">.<strong>visit_table_data</strong>(flights, sort_category = nil, sort_direectionection = nil)  &#x21d2; Array&lt;Hash&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns an array of airports, with a hash for each airport containing the
id, airport name, IATA code, and number of visits to that airport, sorted
by number of visits descending.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#coordinates-instance_method" title="#coordinates (instance method)">#<strong>coordinates</strong>  &#x21d2; Array&lt;Float&gt;<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the airport&#39;s latitude and longitude in decimal degrees.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remote_airport-instance_method" title="#remote_airport (instance method)">#<strong>remote_airport</strong>(id_1, id_2)  &#x21d2; Integer<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Given two IDs, returns the one that is not associated with this <span class='object_link'><a href="" title="Airport (class)">Airport</a></span>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#terminal_silhouette_large_path-instance_method" title="#terminal_silhouette_large_path (instance method)">#<strong>terminal_silhouette_large_path</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the image path for this airport&#39;s uncropped terminal
silhouette.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#terminal_silhouette_path-instance_method" title="#terminal_silhouette_path (instance method)">#<strong>terminal_silhouette_path</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the image path for this airport&#39;s cropped terminal silhouette.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  

  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="convert_iata_to_icao-class_method">
  
    .<strong>convert_iata_to_icao</strong>(iata, keep_iata = true)  &#x21d2; <tt>String</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Accepts an airport IATA code, and returns the matching ICAO code.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>iata</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the airport IATA code to look up</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>keep_iata</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>whether or not to return the provided IATA code if an ICAO code is not
found. If this is false, the method will return nil if an ICAO code is not
found.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a matching ICAO code if found, the provided IATA code or nil if not found</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


83
84
85
86
87
88
89
90
91</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/airport.rb', line 83</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_convert_iata_to_icao'>convert_iata_to_icao</span><span class='lparen'>(</span><span class='id identifier rubyid_iata'>iata</span><span class='comma'>,</span> <span class='id identifier rubyid_keep_iata'>keep_iata</span><span class='op'>=</span><span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_airport'>airport</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Airport (class)">Airport</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span><span class='label'>iata_code:</span> <span class='id identifier rubyid_iata'>iata</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_airport'>airport</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
     <span class='kw'>return</span> <span class='id identifier rubyid_keep_iata'>keep_iata</span> <span class='op'>?</span> <span class='id identifier rubyid_iata'>iata</span> <span class='op'>:</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_icao'>icao</span> <span class='op'>=</span> <span class='id identifier rubyid_airport'>airport</span><span class='period'>.</span><span class='id identifier rubyid_icao_code'>icao_code</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_icao'>icao</span> <span class='kw'>if</span> <span class='id identifier rubyid_icao'>icao</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_keep_iata'>keep_iata</span> <span class='op'>?</span> <span class='id identifier rubyid_iata'>iata</span> <span class='op'>:</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="direct_flight_count-class_method">
  
    .<strong>direct_flight_count</strong>(flights, direct_flight_airport, sort_category = nil, sort_direction = nil)  &#x21d2; <tt>Array&lt;Hash&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Given a collection of flights and a direct flight <span class='object_link'><a href="" title="Airport (class)">Airport</a></span>, returns data
about the direct flights to or from the specified airport within the flight
collection. Returns an array with a hash for each remote airport, with each
hash containing the airport name, IATA code, country, distance in miles to
the direct flight airport, and count of direct flights to or from the
direct flight airport.</p>

<p>Used on <span class='object_link'><a href="AirportsController.html#show-instance_method" title="AirportsController#show (method)">AirportsController#show</a></span> to generate the Direct Flight Airports
table.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>Airport.direct_flight_count(Flight.all, Airport.find(1)) #=&gt; [
  {:iata_code=&gt;&quot;ORD&quot;, :city=&gt;&quot;Chicago (O’Hare)&quot;, :country=&gt;&quot;United States&quot;, :distance_mi=&gt;801, :total_flights=&gt;6},
  {:iata_code=&gt;&quot;SLC&quot;, :city=&gt;&quot;Salt Lake City&quot;, :country=&gt;&quot;United States&quot;, :distance_mi=&gt;987, :total_flights=&gt;6},
  {:iata_code=&gt;&quot;SEA&quot;, :city=&gt;&quot;Seattle/Tacoma&quot;, :country=&gt;&quot;United States&quot;, :distance_mi=&gt;1658, :total_flights=&gt;4}
]</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>flights</span>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a collection of <span class='object_link'><a href="Flight.html" title="Flight (class)">Flights</a></span> to calculate direct flights within</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>direct_flight_airport</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Airport (class)">Airport</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the airport to calculate direct flights from and to</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>sort_category</span>
      
      
        <span class='type'>(<tt>:city</tt>, <tt>:code</tt>, <tt>:distance</tt>, <tt>:flights</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>the category to sort the array by</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>sort_direction</span>
      
      
        <span class='type'>(<tt>:asc</tt>, <tt>:desc</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>the direction to sort the array</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Hash&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>details for each <span class='object_link'><a href="" title="Airport (class)">Airport</a></span> with direct flights to the
<code>direct_flight_airport</code></p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/airport.rb', line 130</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_direct_flight_count'>direct_flight_count</span><span class='lparen'>(</span><span class='id identifier rubyid_flights'>flights</span><span class='comma'>,</span> <span class='id identifier rubyid_direct_flight_airport'>direct_flight_airport</span><span class='comma'>,</span> <span class='id identifier rubyid_sort_category'>sort_category</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_sort_direction'>sort_direction</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  
  <span class='comment'># Filter flights to only flights involving the direct_flight_airport:
</span>  <span class='id identifier rubyid_flights'>flights</span> <span class='op'>=</span> <span class='id identifier rubyid_flights'>flights</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='id identifier rubyid_f'>f</span><span class='lbracket'>[</span><span class='symbol'>:origin_airport_id</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_direct_flight_airport'>direct_flight_airport</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>||</span> <span class='id identifier rubyid_f'>f</span><span class='lbracket'>[</span><span class='symbol'>:destination_airport_id</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_direct_flight_airport'>direct_flight_airport</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbrace'>}</span>
  
  <span class='comment'># Calculate direct flight counts by airport id:
</span>  <span class='id identifier rubyid_count_by_id'>count_by_id</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_flights'>flights</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_flight'>flight</span><span class='op'>|</span>
    <span class='id identifier rubyid_count_by_id'>count_by_id</span><span class='lbracket'>[</span><span class='id identifier rubyid_direct_flight_airport'>direct_flight_airport</span><span class='period'>.</span><span class='id identifier rubyid_remote_airport'>remote_airport</span><span class='lparen'>(</span><span class='id identifier rubyid_flight'>flight</span><span class='lbracket'>[</span><span class='symbol'>:origin_airport_id</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_flight'>flight</span><span class='lbracket'>[</span><span class='symbol'>:destination_airport_id</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>end</span>

  <span class='comment'># Calculate flight distances by remote airport id:
</span>  <span class='id identifier rubyid_distance_by_id'>distance_by_id</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_routes'>routes</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Route.html" title="Route (class)">Route</a></span></span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>airport1_id:</span> <span class='id identifier rubyid_count_by_id'>count_by_id</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='comma'>,</span> <span class='label'>airport2_id:</span> <span class='id identifier rubyid_direct_flight_airport'>direct_flight_airport</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_or'>or</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Route.html" title="Route (class)">Route</a></span></span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>airport1_id:</span> <span class='id identifier rubyid_direct_flight_airport'>direct_flight_airport</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='label'>airport2_id:</span> <span class='id identifier rubyid_count_by_id'>count_by_id</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_pluck'>pluck</span><span class='lparen'>(</span><span class='symbol'>:airport1_id</span><span class='comma'>,</span><span class='symbol'>:airport2_id</span><span class='comma'>,</span><span class='symbol'>:distance_mi</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_routes'>routes</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_route'>route</span><span class='op'>|</span>
    <span class='id identifier rubyid_distance_by_id'>distance_by_id</span><span class='lbracket'>[</span><span class='id identifier rubyid_direct_flight_airport'>direct_flight_airport</span><span class='period'>.</span><span class='id identifier rubyid_remote_airport'>remote_airport</span><span class='lparen'>(</span><span class='id identifier rubyid_route'>route</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_route'>route</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_route'>route</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Fill in airport details:
</span>  <span class='id identifier rubyid_airports'>airports</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Airport (class)">Airport</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_count_by_id'>count_by_id</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_pluck'>pluck</span><span class='lparen'>(</span><span class='symbol'>:id</span><span class='comma'>,</span> <span class='symbol'>:iata_code</span><span class='comma'>,</span> <span class='symbol'>:city</span><span class='comma'>,</span> <span class='symbol'>:country</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_airports'>airports</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>|</span> <span class='lbrace'>{</span><span class='label'>iata_code:</span> <span class='id identifier rubyid_a'>a</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>city:</span> <span class='id identifier rubyid_a'>a</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>country:</span> <span class='id identifier rubyid_a'>a</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>distance_mi:</span> <span class='id identifier rubyid_distance_by_id'>distance_by_id</span><span class='lbracket'>[</span><span class='id identifier rubyid_a'>a</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>total_flights:</span> <span class='id identifier rubyid_count_by_id'>count_by_id</span><span class='lbracket'>[</span><span class='id identifier rubyid_a'>a</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='rbrace'>}</span>

  <span class='comment'># Sort array:
</span>  <span class='id identifier rubyid_sort_mult'>sort_mult</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_sort_direction'>sort_direction</span> <span class='op'>==</span> <span class='symbol'>:asc</span> <span class='op'>?</span> <span class='int'>1</span> <span class='op'>:</span> <span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_sort_category'>sort_category</span>
  <span class='kw'>when</span> <span class='symbol'>:city</span>
    <span class='id identifier rubyid_airports'>airports</span><span class='period'>.</span><span class='id identifier rubyid_sort_by!'>sort_by!</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_airport'>airport</span><span class='op'>|</span> <span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:city</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_airports'>airports</span><span class='period'>.</span><span class='id identifier rubyid_reverse!'>reverse!</span> <span class='kw'>if</span> <span class='id identifier rubyid_sort_direction'>sort_direction</span> <span class='op'>==</span> <span class='symbol'>:desc</span>
  <span class='kw'>when</span> <span class='symbol'>:code</span>
    <span class='id identifier rubyid_airports'>airports</span><span class='period'>.</span><span class='id identifier rubyid_sort_by!'>sort_by!</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_airport'>airport</span><span class='op'>|</span> <span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:iata_code</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_airports'>airports</span><span class='period'>.</span><span class='id identifier rubyid_reverse!'>reverse!</span> <span class='kw'>if</span> <span class='id identifier rubyid_sort_direction'>sort_direction</span> <span class='op'>==</span> <span class='symbol'>:desc</span>
  <span class='kw'>when</span> <span class='symbol'>:flights</span>
    <span class='id identifier rubyid_airports'>airports</span><span class='period'>.</span><span class='id identifier rubyid_sort_by!'>sort_by!</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_airport'>airport</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_sort_mult'>sort_mult</span><span class='op'>*</span><span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:total_flights</span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:city</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
  <span class='kw'>when</span> <span class='symbol'>:distance</span>
    <span class='id identifier rubyid_airports'>airports</span><span class='period'>.</span><span class='id identifier rubyid_sort_by!'>sort_by!</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_airport'>airport</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_sort_mult'>sort_mult</span><span class='op'>*</span><span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:distance_mi</span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:city</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_airports'>airports</span><span class='period'>.</span><span class='id identifier rubyid_sort_by!'>sort_by!</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_airport'>airport</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='op'>-</span><span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:total_flights</span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:city</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_airports'>airports</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="in_region_hash-class_method">
  
    .<strong>in_region_hash</strong>(icao_starts)  &#x21d2; <tt>Hash&lt;Integer,String&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Take a collection of strings representing the starts of ICAO codes, and
return an a hash of all Airports whose airport ICAO codes start with any of
the provided strings.</p>

<p>Params:</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>icao_starts</span>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an array of strings of the start of ICAO codes (i.e. EG, K)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash&lt;Integer,String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a hash of airports with matching ICAO codes, with airport IDs as keys and
IATA codes as airports</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


267
268
269
270
271
272
273
274
275</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/airport.rb', line 267</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_in_region_hash'>in_region_hash</span><span class='lparen'>(</span><span class='id identifier rubyid_icao_starts'>icao_starts</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_conditions'>conditions</span> <span class='op'>=</span> <span class='id identifier rubyid_icao_starts'>icao_starts</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>icao_code LIKE ?</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> OR </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_patterns'>patterns</span> <span class='op'>=</span> <span class='id identifier rubyid_icao_starts'>icao_starts</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_start'>start</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_start'>start</span><span class='embexpr_end'>}</span><span class='tstring_content'>%</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_matching_airports'>matching_airports</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Airport (class)">Airport</a></span></span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='id identifier rubyid_conditions'>conditions</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_patterns'>patterns</span><span class='rparen'>)</span>
  
  <span class='id identifier rubyid_iata_hash'>iata_hash</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_matching_airports'>matching_airports</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_airport'>airport</span><span class='op'>|</span> <span class='id identifier rubyid_iata_hash'>iata_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:iata_code</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_iata_hash'>iata_hash</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="in_region_iata_codes-class_method">
  
    .<strong>in_region_iata_codes</strong>(icao_starts)  &#x21d2; <tt>Array&lt;String&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Take a collection of strings representing the starts of ICAO codes, and
return all IATA codes whose airport ICAO codes start with any of the
provided strings.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>icao_starts</span>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an array of strings of the start of ICAO codes (i.e. EG, K)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>ICAO codes in the region</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


243
244
245</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/airport.rb', line 243</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_in_region_iata_codes'>in_region_iata_codes</span><span class='lparen'>(</span><span class='id identifier rubyid_icao_starts'>icao_starts</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_in_region_hash'>in_region_hash</span><span class='lparen'>(</span><span class='id identifier rubyid_icao_starts'>icao_starts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_airports'>airports</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="in_region_ids-class_method">
  
    .<strong>in_region_ids</strong>(icao_starts)  &#x21d2; <tt>Array&lt;String&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Take a collection of strings representing the starts of ICAO codes, and
return all airport IDs whose airport ICAO codes start with any of the
provided strings.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>icao_starts</span>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an array of strings of the start of ICAO codes (i.e. EG, K)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>ICAO codes in the region</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


254
255
256</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/airport.rb', line 254</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_in_region_ids'>in_region_ids</span><span class='lparen'>(</span><span class='id identifier rubyid_icao_starts'>icao_starts</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_in_region_hash'>in_region_hash</span><span class='lparen'>(</span><span class='id identifier rubyid_icao_starts'>icao_starts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="new_in_date_range-class_method">
  
    .<strong>new_in_date_range</strong>(flyer, current_user, date_range)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Accepts a flyer, the viewing user, and a date range, and returns the IATA
code for all airports that had their first flight in this date range.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97
98
99
100
101</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/airport.rb', line 95</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_new_in_date_range'>new_in_date_range</span><span class='lparen'>(</span><span class='id identifier rubyid_flyer'>flyer</span><span class='comma'>,</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='comma'>,</span> <span class='id identifier rubyid_date_range'>date_range</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_flights'>flights</span> <span class='op'>=</span> <span class='id identifier rubyid_flyer'>flyer</span><span class='period'>.</span><span class='id identifier rubyid_flights'>flights</span><span class='lparen'>(</span><span class='id identifier rubyid_current_user'>current_user</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reorder'>reorder</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_orig'>orig</span> <span class='op'>=</span> <span class='id identifier rubyid_flights'>flights</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:origin_airport</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='symbol'>:iata_code</span><span class='comma'>,</span> <span class='symbol'>:departure_date</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='lparen'>(</span><span class='symbol'>:iata_code</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_minimum'>minimum</span><span class='lparen'>(</span><span class='symbol'>:departure_date</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_dest'>dest</span> <span class='op'>=</span> <span class='id identifier rubyid_flights'>flights</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:destination_airport</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='symbol'>:iata_code</span><span class='comma'>,</span> <span class='symbol'>:departure_date</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='lparen'>(</span><span class='symbol'>:iata_code</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_minimum'>minimum</span><span class='lparen'>(</span><span class='symbol'>:departure_date</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_first_flights'>first_flights</span> <span class='op'>=</span> <span class='id identifier rubyid_orig'>orig</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_dest'>dest</span><span class='rparen'>)</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span><span class='id identifier rubyid_o'>o</span><span class='comma'>,</span><span class='id identifier rubyid_d'>d</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_o'>o</span><span class='comma'>,</span><span class='id identifier rubyid_d'>d</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span><span class='rbrace'>}</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_first_flights'>first_flights</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_date_range'>date_range</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_k'>k</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="visit_frequencies-class_method">
  
    .<strong>visit_frequencies</strong>(flights)  &#x21d2; <tt>Hash&lt;Integer,Integer&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Take a collection of <span class='object_link'><a href="Flight.html" title="Flight (class)">Flights</a></span>, and return a hash of airport IDs and
number of visits. Used when only a quick lookup of visits is needed; if an
array of data about each airport is needed, <span class='object_link'><a href="#visit_table_data-class_method" title="Airport.visit_table_data (method)">visit_table_data</a></span> should be
used instead.</p>

<p>If two flights are chronologically consecutive, the destination <span class='object_link'><a href="" title="Airport (class)">Airport</a></span>
of the first flight is the same as the origin of the second, and these two
flights share the same <span class='object_link'><a href="Trip.html" title="Trip (class)">Trip</a></span> and trip section, then the time between the
two flights is a layover and only counts as one visit to shared <span class='object_link'><a href="" title="Airport (class)">Airport</a></span>.
Otherwise, the traveler left the airport in between the flights, and it
counts as two separate visits to the shared <span class='object_link'><a href="" title="Airport (class)">Airport</a></span>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>flights</span>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a collection of <span class='object_link'><a href="Flight.html" title="Flight (class)">Flights</a></span></p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash&lt;Integer,Integer&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a hash with airport IDs as keys and number of visits as airports</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/airport.rb', line 292</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_visit_frequencies'>visit_frequencies</span><span class='lparen'>(</span><span class='id identifier rubyid_flights'>flights</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_airport_frequency'>airport_frequency</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span> <span class='comment'># All airports start with 0 flights
</span>  <span class='id identifier rubyid_previous_trip_id'>previous_trip_id</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='semicolon'>;</span>
  <span class='id identifier rubyid_previous_trip_section'>previous_trip_section</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='semicolon'>;</span>
  <span class='id identifier rubyid_previous_destination_airport_iata_code'>previous_destination_airport_iata_code</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='semicolon'>;</span>
  <span class='id identifier rubyid_flights'>flights</span><span class='period'>.</span><span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='symbol'>:origin_airport</span><span class='comma'>,</span> <span class='symbol'>:destination_airport</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_flight'>flight</span><span class='op'>|</span>
    <span class='kw'>unless</span> <span class='lparen'>(</span><span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_trip_id'>trip_id</span> <span class='op'>==</span> <span class='id identifier rubyid_previous_trip_id'>previous_trip_id</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_trip_section'>trip_section</span> <span class='op'>==</span> <span class='id identifier rubyid_previous_trip_section'>previous_trip_section</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_origin_airport'>origin_airport</span><span class='period'>.</span><span class='id identifier rubyid_iata_code'>iata_code</span> <span class='op'>==</span> <span class='id identifier rubyid_previous_destination_airport_iata_code'>previous_destination_airport_iata_code</span><span class='rparen'>)</span>
      <span class='comment'># This is not a layover, so count this origin airport
</span>      <span class='id identifier rubyid_airport_frequency'>airport_frequency</span><span class='lbracket'>[</span><span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_origin_airport_id'>origin_airport_id</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_airport_frequency'>airport_frequency</span><span class='lbracket'>[</span><span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_destination_airport_id'>destination_airport_id</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_previous_trip_id'>previous_trip_id</span> <span class='op'>=</span> <span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_trip_id'>trip_id</span>
    <span class='id identifier rubyid_previous_trip_section'>previous_trip_section</span> <span class='op'>=</span> <span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_trip_section'>trip_section</span>
    <span class='id identifier rubyid_previous_destination_airport_iata_code'>previous_destination_airport_iata_code</span> <span class='op'>=</span> <span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_destination_airport'>destination_airport</span><span class='period'>.</span><span class='id identifier rubyid_iata_code'>iata_code</span>
  <span class='kw'>end</span>
  
  <span class='kw'>return</span> <span class='id identifier rubyid_airport_frequency'>airport_frequency</span>
  
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="visit_table_data-class_method">
  
    .<strong>visit_table_data</strong>(flights, sort_category = nil, sort_direectionection = nil)  &#x21d2; <tt>Array&lt;Hash&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns an array of airports, with a hash for each airport containing the
id, airport name, IATA code, and number of visits to that airport, sorted
by number of visits descending.</p>

<p>Used on various “show” views to generate a table of airports and their
flight counts.</p>

<p>If only a hash of visit counts is needed, <span class='object_link'><a href="#visit_frequencies-class_method" title="Airport.visit_frequencies (method)">visit_frequencies</a></span> should be
used instead.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>flights</span>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a collection of <span class='object_link'><a href="Flight.html" title="Flight (class)">Flights</a></span> to calculate Airport visit counts for</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>sort_category</span>
      
      
        <span class='type'>(<tt>:country</tt>, <tt>:city</tt>, <tt>:code</tt>, <tt>:visits</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>the category to sort the array by</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>sort_direectionection</span>
      
      
        <span class='type'>(<tt>:asc</tt>, <tt>:desc</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>the direction to sort the array</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Hash&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>details for each Airport visited</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/airport.rb', line 188</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_visit_table_data'>visit_table_data</span><span class='lparen'>(</span><span class='id identifier rubyid_flights'>flights</span><span class='comma'>,</span> <span class='id identifier rubyid_sort_category'>sort_category</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_sort_direectionection'>sort_direectionection</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_flights'>flights</span> <span class='op'>=</span> <span class='id identifier rubyid_flights'>flights</span><span class='period'>.</span><span class='id identifier rubyid_reorder'>reorder</span><span class='lparen'>(</span><span class='symbol'>:trip_id</span><span class='comma'>,</span> <span class='symbol'>:trip_section</span><span class='comma'>,</span> <span class='symbol'>:departure_utc</span><span class='rparen'>)</span>
  
  <span class='id identifier rubyid_visits'>visits</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_previous_trip_section'>previous_trip_section</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='label'>trip_id:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>trip_section:</span> <span class='kw'>nil</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_previous_destination'>previous_destination</span> <span class='op'>=</span> <span class='kw'>nil</span>
  
  <span class='id identifier rubyid_flights'>flights</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_flight'>flight</span><span class='op'>|</span>
    <span class='id identifier rubyid_current_trip_section'>current_trip_section</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='label'>trip_id:</span> <span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_trip_id'>trip_id</span><span class='comma'>,</span> <span class='label'>trip_section:</span> <span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_trip_section'>trip_section</span>
    <span class='rbrace'>}</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_current_trip_section'>current_trip_section</span> <span class='op'>==</span> <span class='id identifier rubyid_previous_trip_section'>previous_trip_section</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_origin_airport'>origin_airport</span><span class='period'>.</span><span class='id identifier rubyid_iata_code'>iata_code</span> <span class='op'>==</span> <span class='id identifier rubyid_previous_destination'>previous_destination</span>
      <span class='comment'># This is not a layover, so count this origin airport
</span>      <span class='id identifier rubyid_visits'>visits</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_origin_airport'>origin_airport</span><span class='period'>.</span><span class='id identifier rubyid_iata_code'>iata_code</span><span class='comma'>,</span><span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_origin_airport'>origin_airport</span><span class='period'>.</span><span class='id identifier rubyid_city'>city</span><span class='comma'>,</span><span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_origin_airport'>origin_airport</span><span class='period'>.</span><span class='id identifier rubyid_country'>country</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_visits'>visits</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_destination_airport'>destination_airport</span><span class='period'>.</span><span class='id identifier rubyid_iata_code'>iata_code</span><span class='comma'>,</span><span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_destination_airport'>destination_airport</span><span class='period'>.</span><span class='id identifier rubyid_city'>city</span><span class='comma'>,</span><span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_destination_airport'>destination_airport</span><span class='period'>.</span><span class='id identifier rubyid_country'>country</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_previous_trip_section'>previous_trip_section</span> <span class='op'>=</span> <span class='id identifier rubyid_current_trip_section'>current_trip_section</span>
    <span class='id identifier rubyid_previous_destination'>previous_destination</span> <span class='op'>=</span> <span class='id identifier rubyid_flight'>flight</span><span class='period'>.</span><span class='id identifier rubyid_destination_airport'>destination_airport</span><span class='period'>.</span><span class='id identifier rubyid_iata_code'>iata_code</span>
    
  <span class='kw'>end</span>
  
  <span class='id identifier rubyid_counts'>counts</span> <span class='op'>=</span> <span class='id identifier rubyid_visits'>visits</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='lbrace'>{</span><span class='label'>iata_code:</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>city:</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>country:</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>visit_count:</span> <span class='id identifier rubyid_v'>v</span><span class='rbrace'>}</span>
  <span class='rbrace'>}</span>

  <span class='kw'>case</span> <span class='id identifier rubyid_sort_category'>sort_category</span>
  <span class='kw'>when</span> <span class='symbol'>:country</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_sort_direectionection'>sort_direectionection</span> <span class='op'>==</span> <span class='symbol'>:asc</span>
      <span class='id identifier rubyid_counts'>counts</span><span class='period'>.</span><span class='id identifier rubyid_sort_by!'>sort_by!</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_airport'>airport</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:country</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:city</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_counts'>counts</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_b'>b</span><span class='lbracket'>[</span><span class='symbol'>:country</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='lbracket'>[</span><span class='symbol'>:city</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>&lt;=&gt;</span> <span class='lbracket'>[</span><span class='id identifier rubyid_a'>a</span><span class='lbracket'>[</span><span class='symbol'>:country</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='lbracket'>[</span><span class='symbol'>:city</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>when</span> <span class='symbol'>:city</span>
    <span class='id identifier rubyid_counts'>counts</span><span class='period'>.</span><span class='id identifier rubyid_sort_by!'>sort_by!</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_airport'>airport</span><span class='op'>|</span> <span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:city</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_counts'>counts</span><span class='period'>.</span><span class='id identifier rubyid_reverse!'>reverse!</span> <span class='kw'>if</span> <span class='id identifier rubyid_sort_direectionection'>sort_direectionection</span> <span class='op'>==</span> <span class='symbol'>:desc</span>
  <span class='kw'>when</span> <span class='symbol'>:code</span>
    <span class='id identifier rubyid_counts'>counts</span><span class='period'>.</span><span class='id identifier rubyid_sort_by!'>sort_by!</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_airport'>airport</span><span class='op'>|</span> <span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:iata_code</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_counts'>counts</span><span class='period'>.</span><span class='id identifier rubyid_reverse!'>reverse!</span> <span class='kw'>if</span> <span class='id identifier rubyid_sort_direectionection'>sort_direectionection</span> <span class='op'>==</span> <span class='symbol'>:desc</span>
  <span class='kw'>when</span> <span class='symbol'>:visits</span>
    <span class='id identifier rubyid_sort_mult'>sort_mult</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_sort_direectionection'>sort_direectionection</span> <span class='op'>==</span> <span class='symbol'>:desc</span> <span class='op'>?</span> <span class='op'>-</span><span class='int'>1</span> <span class='op'>:</span> <span class='int'>1</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_counts'>counts</span><span class='period'>.</span><span class='id identifier rubyid_sort_by!'>sort_by!</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_airport'>airport</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_sort_mult'>sort_mult</span><span class='op'>*</span><span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:visit_count</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:city</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>    
    <span class='id identifier rubyid_counts'>counts</span><span class='period'>.</span><span class='id identifier rubyid_sort_by!'>sort_by!</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_airport'>airport</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='op'>-</span><span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:visit_count</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:city</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_airport'>airport</span><span class='lbracket'>[</span><span class='symbol'>:iata_code</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>return</span> <span class='id identifier rubyid_counts'>counts</span>
  
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="coordinates-instance_method">
  
    #<strong>coordinates</strong>  &#x21d2; <tt>Array&lt;Float&gt;</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the airport&#39;s latitude and longitude in decimal degrees. If the
latitude and longitude aren&#39;t defined, this method attempts to look
them up using the FlightXML API and save them, and then returns the
coordinate array. If this is not successful, returns nil.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Float&gt;</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the latitude and longitude in decimal degrees</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/airport.rb', line 28</span>

<span class='kw'>def</span> <span class='id identifier rubyid_coordinates'>coordinates</span>
  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_latitude'>latitude</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span> <span class='op'>&amp;&amp;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_longitude'>longitude</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_latitude'>latitude</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_longitude'>longitude</span><span class='rbracket'>]</span>
  <span class='kw'>elsif</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_icao_code'>icao_code</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
    <span class='comment'># Try to look up coordinates on FlightXML
</span>    <span class='id identifier rubyid_coordinates'>coordinates</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="FlightXML.html" title="FlightXML (module)">FlightXML</a></span></span><span class='period'>.</span><span class='id identifier rubyid_airport_coordinates'><span class='object_link'><a href="FlightXML.html#airport_coordinates-class_method" title="FlightXML.airport_coordinates (method)">airport_coordinates</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_icao_code'>icao_code</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_coordinates'>coordinates</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
    <span class='comment'># Save coordinates to instance
</span>    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_latitude'>latitude</span> <span class='op'>=</span> <span class='id identifier rubyid_coordinates'>coordinates</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_longitude'>longitude</span> <span class='op'>=</span> <span class='id identifier rubyid_coordinates'>coordinates</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_coordinates'>coordinates</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remote_airport-instance_method">
  
    #<strong>remote_airport</strong>(id_1, id_2)  &#x21d2; <tt>Integer</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Given two IDs, returns the one that is not associated with this <span class='object_link'><a href="" title="Airport (class)">Airport</a></span>.
If both are associated with this airport (a flight where the origin and
destination are the same) then this airport&#39;s ID will be returned. If
neither are associated with this airport, nil will be returned.</p>

<p>Used by <span class='object_link'><a href="#direct_flight_count-class_method" title="Airport.direct_flight_count (method)">direct_flight_count</a></span> to determine which airport on a direct
<span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span> is the remote airport.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id_1</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an <span class='object_link'><a href="" title="Airport (class)">Airport</a></span> ID</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>id_2</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an <span class='object_link'><a href="" title="Airport (class)">Airport</a></span> ID</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the remote <span class='object_link'><a href="" title="Airport (class)">Airport</a></span> ID</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


56
57
58
59</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/airport.rb', line 56</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remote_airport'>remote_airport</span><span class='lparen'>(</span><span class='id identifier rubyid_id_1'>id_1</span><span class='comma'>,</span> <span class='id identifier rubyid_id_2'>id_2</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='lbracket'>[</span><span class='id identifier rubyid_id_1'>id_1</span><span class='comma'>,</span> <span class='id identifier rubyid_id_2'>id_2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>==</span> <span class='id identifier rubyid_id_1'>id_1</span> <span class='op'>?</span> <span class='id identifier rubyid_id_2'>id_2</span> <span class='op'>:</span> <span class='id identifier rubyid_id_1'>id_1</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="terminal_silhouette_large_path-instance_method">
  
    #<strong>terminal_silhouette_large_path</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the image path for this airport&#39;s uncropped terminal
silhouette.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an image path</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


72
73
74</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/airport.rb', line 72</span>

<span class='kw'>def</span> <span class='id identifier rubyid_terminal_silhouette_large_path'>terminal_silhouette_large_path</span>
  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="ExternalImage.html" title="ExternalImage (module)">ExternalImage</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="ExternalImage.html#ROOT_PATH-constant" title="ExternalImage::ROOT_PATH (constant)">ROOT_PATH</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>/projects/terminal-silhouettes/png/</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_iata_code'>iata_code</span><span class='embexpr_end'>}</span><span class='tstring_content'>.png</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="terminal_silhouette_path-instance_method">
  
    #<strong>terminal_silhouette_path</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the image path for this airport&#39;s cropped terminal silhouette.
This image is always 1440px wide, and is up to 810px tall.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an image path</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/airport.rb', line 65</span>

<span class='kw'>def</span> <span class='id identifier rubyid_terminal_silhouette_path'>terminal_silhouette_path</span>
  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="ExternalImage.html" title="ExternalImage (module)">ExternalImage</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="ExternalImage.html#ROOT_PATH-constant" title="ExternalImage::ROOT_PATH (constant)">ROOT_PATH</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>/projects/terminal-silhouettes/png-flight-historian/</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_iata_code'>iata_code</span><span class='embexpr_end'>}</span><span class='tstring_content'>.png</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sat Jul 27 09:51:39 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.19 (ruby-2.3.1).
</div>

    </div>
  </body>
</html>