<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Trip
  
    &mdash; Documentation by YARD 0.9.19
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Trip";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (T)</a> &raquo;
    
    
    <span class="title">Trip</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Trip
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ActiveRecord::Base</li>
          
            <li class="next"><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></li>
          
            <li class="next">Trip</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/models/trip.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Defines a model for trips.</p>

<p>Within the <span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span> model, a <span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span> contains both a reference to a Trip
ID and an integer trip section number. Trip sections are used to
distinguish between layovers and multiple visits to a given airport within
a given Trip, in the situation where two <span class='object_link'><a href="Flight.html" title="Flight (class)">Flights</a></span> are
chronologically consecutive and the destination <span class='object_link'><a href="Airport.html" title="Airport (class)">Airport</a></span> of the first
<span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span> is the same as the origin of the second. If these two flights
share the same Trip ID and trip section, then the time between the two
<span class='object_link'><a href="Flight.html" title="Flight (class)">Flights</a></span> is a layover and only counts as one visit to shared
<span class='object_link'><a href="Airport.html" title="Airport (class)">Airport</a></span>. Otherwise, the traveler left the airport in between the <span class='object_link'><a href="Flight.html" title="Flight (class)">Flights</a></span>, and it counts as two separate visits to the shared <span class='object_link'><a href="Airport.html" title="Airport (class)">Airport</a></span>.</p>

<p>Trips can be marked as hidden, which means they (and their <span class='object_link'><a href="Flight.html" title="Flight (class)">Flights</a></span>) will not be included in views and flight data for anybody other
than the <span class='object_link'><a href="User.html" title="User (class)">User</a></span> who they belong to.</p>


  </div>
</div>
<div class="tags">
  

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="HIDDEN_MARKER-constant" class="">HIDDEN_MARKER =
          <div class="docstring">
  <div class="discussion">
    
<p>HTML to use to indicate a trip is hidden, or a flight is part of a hidden
trip.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>ActionController</span><span class='op'>::</span><span class='const'>Base</span><span class='period'>.</span><span class='id identifier rubyid_helpers'>helpers</span><span class='period'>.</span><span class='id identifier rubyid_content_tag'>content_tag</span><span class='lparen'>(</span><span class='symbol'>:div</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hidden</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>class:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hidden-marker</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></pre></dd>
      
        <dt id="NULL_ATTRS-constant" class="">NULL_ATTRS =
          <div class="docstring">
  <div class="discussion">
    
<p>Form fields which should be saved as nil when the field is blank.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='qwords_beg'>%w( </span><span class='tstring_content'>comment</span><span class='words_sep'> )</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#purposes_list-class_method" title="purposes_list (class method)">.<strong>purposes_list</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a hash of possible trip purposes.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#with_departure_dates-class_method" title="with_departure_dates (class method)">.<strong>with_departure_dates</strong>(flyer, current_user)  &#x21d2; Array&lt;Hash&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a collection of trip IDs, names, and departure dates.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#with_no_flights-class_method" title="with_no_flights (class method)">.<strong>with_no_flights</strong>  &#x21d2; Array&lt;Trip&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a collection of Trips which have no <span class='object_link'><a href="Flight.html" title="Flight (class)">Flights</a></span>.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#estimated_trip_section-instance_method" title="#estimated_trip_section (instance method)">#<strong>estimated_trip_section</strong>(departure_utc)  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Takes a flight departure time, and returns the trip section this <span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span>
most likely belongs to.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#layover_ratio-instance_method" title="#layover_ratio (instance method)">#<strong>layover_ratio</strong>(section)  &#x21d2; Float<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Within a trip section, calculates the ratio of the sum of the direct flight
distances of each <span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span> to the distance of a direct flight between the
first origin and last destination.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  

  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="purposes_list-class_method">
  
    .<strong>purposes_list</strong>  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a hash of possible trip purposes. Used to populate the trip purpose
select box on the <span class='object_link'><a href="TripsController.html#new-instance_method" title="TripsController#new (method)">new</a></span> or <span class='object_link'><a href="TripsController.html#edit-instance_method" title="TripsController#edit (method)">edit</a></span>
Trip forms.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>trip purposes</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


81
82
83
84
85
86
87</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/trip.rb', line 81</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_purposes_list'>purposes_list</span>
  <span class='id identifier rubyid_purposes'>purposes</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_purposes'>purposes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>business</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Business</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_purposes'>purposes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>mixed</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Mixed</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_purposes'>purposes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>personal</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Personal</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>return</span> <span class='id identifier rubyid_purposes'>purposes</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="with_departure_dates-class_method">
  
    .<strong>with_departure_dates</strong>(flyer, current_user)  &#x21d2; <tt>Array&lt;Hash&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a collection of trip IDs, names, and departure dates. Used in
<span class='object_link'><a href="TripsController.html#index-instance_method" title="TripsController#index (method)">TripsController#index</a></span> to show a list of trips.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>flyer</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="User.html" title="User (class)">User</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the <span class='object_link'><a href="User.html" title="User (class)">User</a></span> whose trips are to be shown</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>current_user</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="User.html" title="User (class)">User</a></span></tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the <span class='object_link'><a href="User.html" title="User (class)">User</a></span> (or visitor if nil) viewing the list of trips</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Hash&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an array of trip details</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


96
97
98
99
100
101
102
103
104</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/trip.rb', line 96</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_with_departure_dates'>with_departure_dates</span><span class='lparen'>(</span><span class='id identifier rubyid_flyer'>flyer</span><span class='comma'>,</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_flyer'>flyer</span> <span class='op'>==</span> <span class='id identifier rubyid_current_user'>current_user</span>
    <span class='id identifier rubyid_trips'>trips</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Trip (class)">Trip</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find_by_sql'>find_by_sql</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT flights.trip_id, trips.id, trips.name, trips.hidden, MIN(flights.departure_date) AS departure_date FROM flights JOIN trips ON flights.trip_id = trips.id WHERE trips.user_id = 1 GROUP BY flights.trip_id, trips.id, trips.name, trips.hidden ORDER BY departure_date</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_flyer'>flyer</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_trips'>trips</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Trip (class)">Trip</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find_by_sql'>find_by_sql</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT flights.trip_id, trips.id, trips.name, trips.hidden, MIN(flights.departure_date) AS departure_date FROM flights JOIN trips ON flights.trip_id = trips.id WHERE trips.user_id = ? AND trips.hidden = false GROUP BY flights.trip_id, trips.id, trips.name, trips.hidden ORDER BY departure_date</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_flyer'>flyer</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_trips'>trips</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="with_no_flights-class_method">
  
    .<strong>with_no_flights</strong>  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="" title="Trip (class)">Trip</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a collection of Trips which have no <span class='object_link'><a href="Flight.html" title="Flight (class)">Flights</a></span>. Used in
<span class='object_link'><a href="TripsController.html#index-instance_method" title="TripsController#index (method)">TripsController#index</a></span> to allow a verified <span class='object_link'><a href="User.html" title="User (class)">User</a></span> to select a Trip which
they have not yet added any <span class='object_link'><a href="Flight.html" title="Flight (class)">Flights</a></span> to.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="" title="Trip (class)">Trip</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Trips with no <span class='object_link'><a href="Flight.html" title="Flight (class)">Flights</a></span></p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


111
112
113</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/trip.rb', line 111</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_with_no_flights'>with_no_flights</span>
  <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="" title="Trip (class)">Trip</a></span></span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id not in (?)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="" title="Trip (class)">Trip</a></span></span><span class='period'>.</span><span class='id identifier rubyid_distinct'>distinct</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:flights</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>trips.id</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="estimated_trip_section-instance_method">
  
    #<strong>estimated_trip_section</strong>(departure_utc)  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Takes a flight departure time, and returns the trip section this <span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span>
most likely belongs to. Used while prepopulating the <span class='object_link'><a href="FlightsController.html#new-instance_method" title="FlightsController#new (method)">new Flight</a></span> form to guess whether a new <span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span> is more likely to be part
of the previous flight&#39;s trip section or a new trip section.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>departure_utc</span>
      
      
        <span class='type'>(<tt>DateTime</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the UTC departure time of the new <span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span></p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the most likely trip section for this new flight</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45
46
47
48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/trip.rb', line 38</span>

<span class='kw'>def</span> <span class='id identifier rubyid_estimated_trip_section'>estimated_trip_section</span><span class='lparen'>(</span><span class='id identifier rubyid_departure_utc'>departure_utc</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_flights'>flights</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_flights'>flights</span><span class='period'>.</span><span class='id identifier rubyid_chronological'>chronological</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_flights'>flights</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_last_flight'>last_flight</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_flights'>flights</span><span class='period'>.</span><span class='id identifier rubyid_chronological'>chronological</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_departure_utc'>departure_utc</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_departure_utc'>departure_utc</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_last_flight'>last_flight</span><span class='period'>.</span><span class='id identifier rubyid_departure_utc'>departure_utc</span> <span class='op'>+</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_day'>day</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_last_flight'>last_flight</span><span class='period'>.</span><span class='id identifier rubyid_trip_section'>trip_section</span> <span class='op'>+</span> <span class='int'>1</span>
    <span class='kw'>else</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_last_flight'>last_flight</span><span class='period'>.</span><span class='id identifier rubyid_trip_section'>trip_section</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='int'>1</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="layover_ratio-instance_method">
  
    #<strong>layover_ratio</strong>(section)  &#x21d2; <tt>Float</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Within a trip section, calculates the ratio of the sum of the direct flight
distances of each <span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span> to the distance of a direct flight between the
first origin and last destination. If the trip section has no flights, or
if the trip section covers no net distance (it begins and ends at the same
airport), then this method returns nil.</p>

<p>This calculation is used to determine how “bad” a layover is in terms of
extra distance added. A layover ratio of 1 means any layovers did not add
any distance to the trip section. Higher numbers represent how many times
longer the trip was; for example, a layover ratio of 2 means the trip
section distance was twice as long as the theoretical best distance.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>section</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the section of this trip to calculate the layover ratio for</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Float</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the layover ratio</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


67
68
69
70
71
72
73
74</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/trip.rb', line 67</span>

<span class='kw'>def</span> <span class='id identifier rubyid_layover_ratio'>layover_ratio</span><span class='lparen'>(</span><span class='id identifier rubyid_section'>section</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_flights'>flights</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_flights'>flights</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>trip_section:</span> <span class='id identifier rubyid_section'>section</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='symbol'>:departure_utc</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_flights'>flights</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
  <span class='id identifier rubyid_ideal_distance'>ideal_distance</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Route.html" title="Route (class)">Route</a></span></span><span class='period'>.</span><span class='id identifier rubyid_distance_by_airport'><span class='object_link'><a href="Route.html#distance_by_airport-class_method" title="Route.distance_by_airport (method)">distance_by_airport</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_flights'>flights</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_origin_airport'>origin_airport</span><span class='comma'>,</span> <span class='id identifier rubyid_flights'>flights</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_destination_airport'>destination_airport</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_ideal_distance'>ideal_distance</span> <span class='op'>&gt;</span> <span class='int'>0</span>
  <span class='id identifier rubyid_flown_distance'>flown_distance</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Route.html" title="Route (class)">Route</a></span></span><span class='period'>.</span><span class='id identifier rubyid_total_distance'><span class='object_link'><a href="Route.html#total_distance-class_method" title="Route.total_distance (method)">total_distance</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_flights'>flights</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='lparen'>(</span><span class='id identifier rubyid_flown_distance'>flown_distance</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span><span class='rparen'>)</span><span class='op'>/</span><span class='lparen'>(</span><span class='id identifier rubyid_ideal_distance'>ideal_distance</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sun Jun 23 16:54:15 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.19 (ruby-2.3.1).
</div>

    </div>
  </body>
</html>