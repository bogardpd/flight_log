<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: FlightXML
  
    &mdash; Documentation by YARD 0.9.19
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "FlightXML";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (F)</a> &raquo;
    
    
    <span class="title">FlightXML</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: FlightXML
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/modules/flight_xml.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Provides utilities for interacting with with FlightAware&#39;s FlightXML
API.</p>

<p>This is used to look up <span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span> data that couldn&#39;t be found from a
<span class='object_link'><a href="BoardingPass.html" title="BoardingPass (class)">BoardingPass</a></span> or <span class='object_link'><a href="PKPass.html" title="PKPass (class)">PKPass</a></span> for the purposes of prepopulating the
<span class='object_link'><a href="FlightsController.html#new-instance_method" title="FlightsController#new (method)">new flight</a></span> form. It&#39;s also used to look up
<span class='object_link'><a href="Airport.html" title="Airport (class)">Airport</a></span> data when creating a <span class='object_link'><a href="AirportsController.html#new-instance_method" title="AirportsController#new (method)">new airport</a></span>.</p>

<p>Note: Since FlightXML has its own database of flights, airports, and
routes, when you see these terms in this documentation, it refers to
FlightXML and not this applications models, unless it specifically links to
<span class='object_link'><a href="Flight.html" title="Flight (class)">Flight</a></span>, <span class='object_link'><a href="Airport.html" title="Airport (class)">Airport</a></span>, or <span class='object_link'><a href="Route.html" title="Route (class)">Route</a></span>.</p>

<p>Uses the <a href="http://savonrb.com/" target="_parent" title="Savon">Savon</a> gem as a SOAP client to interact with
FlightXML.</p>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://flightaware.com/commercial/flightxml/documentation2.rvt" target="_parent" title="FlightXML 2.0 Documentation">FlightXML 2.0 Documentation</a></li>
    
      <li><a href="http://savonrb.com/" target="_parent" title="Savon">Savon</a></li>
    
  </ul>

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="ERROR-constant" class="">ERROR =
          <div class="docstring">
  <div class="discussion">
    
<p>The default error message to return if a FlightXML lookup failed.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>We couldnâ€™t find your flight data on FlightAware. You will have to manually enter some fields.</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#airport_coordinates-class_method" title="airport_coordinates (class method)">.<strong>airport_coordinates</strong>(airport_icao)  &#x21d2; Array&lt;Float&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Looks up the latitude and longitude for an ICAO airport code.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#airport_timezone-class_method" title="airport_timezone (class method)">.<strong>airport_timezone</strong>(airport_icao)  &#x21d2; TZInfo::DataTimezone </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Looks up the timezone for an ICAO airport code.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#airport_timezones-class_method" title="airport_timezones (class method)">.<strong>airport_timezones</strong>(airport_icao_array)  &#x21d2; Hash{String =&gt; TZInfo::DataTimezone} </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Looks up the timezones for multiple ICAO airport codes.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#client-class_method" title="client (class method)">.<strong>client</strong>  &#x21d2; Savon::Client </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Defines the Savon client to connect to the FlightXML API.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#flight_lookup-class_method" title="flight_lookup (class method)">.<strong>flight_lookup</strong>(ident)  &#x21d2; Array&lt;Hash&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Looks up flight data for flights matching a flight identifier string.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#form_values-class_method" title="form_values (class method)">.<strong>form_values</strong>(fa_flight_id)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Looks up flight data for a FlightXML fa_flight_id.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_flight_id-class_method" title="get_flight_id (class method)">.<strong>get_flight_id</strong>(ident, departure_utc)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Looks up a FlightXML unique flight ID for flights matching a flight
identifier string and UTC departure date/time.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="airport_coordinates-class_method">
  
    .<strong>airport_coordinates</strong>(airport_icao)  &#x21d2; <tt>Array&lt;Float&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Looks up the latitude and longitude for an ICAO airport code.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>airport_icao</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an ICAO airport code</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Float&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>latitude and longitude in decimal degrees</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


33
34
35
36
37
38
39
40
41
42</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/modules/flight_xml.rb', line 33</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_airport_coordinates'>airport_coordinates</span><span class='lparen'>(</span><span class='id identifier rubyid_airport_icao'>airport_icao</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_pos'>pos</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:airport_info</span><span class='comma'>,</span> <span class='label'>message:</span> <span class='lbrace'>{</span>
      <span class='label'>airport_code:</span> <span class='id identifier rubyid_airport_icao'>airport_icao</span>
      <span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span><span class='lbracket'>[</span><span class='symbol'>:airport_info_results</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:airport_info_result</span><span class='rbracket'>]</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_pos'>pos</span><span class='lbracket'>[</span><span class='symbol'>:latitude</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span><span class='comma'>,</span> <span class='id identifier rubyid_pos'>pos</span><span class='lbracket'>[</span><span class='symbol'>:longitude</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span><span class='rbracket'>]</span>
  <span class='kw'>rescue</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="airport_timezone-class_method">
  
    .<strong>airport_timezone</strong>(airport_icao)  &#x21d2; <tt>TZInfo::DataTimezone</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Looks up the timezone for an ICAO airport code.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>airport_icao</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an ICAO airport code</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>TZInfo::DataTimezone</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a timezone</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


48
49
50
51
52
53
54
55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/modules/flight_xml.rb', line 48</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_airport_timezone'>airport_timezone</span><span class='lparen'>(</span><span class='id identifier rubyid_airport_icao'>airport_icao</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_tz'>tz</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:airport_info</span><span class='comma'>,</span> <span class='label'>message:</span> <span class='lbrace'>{</span>
      <span class='label'>airport_code:</span> <span class='id identifier rubyid_airport_icao'>airport_icao</span>
      <span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span><span class='lbracket'>[</span><span class='symbol'>:airport_info_results</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:airport_info_result</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:timezone</span><span class='rbracket'>]</span>
    <span class='kw'>return</span> <span class='const'>TZInfo</span><span class='op'>::</span><span class='const'>Timezone</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='id identifier rubyid_tz'>tz</span><span class='period'>.</span><span class='id identifier rubyid_tr'>tr</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="airport_timezones-class_method">
  
    .<strong>airport_timezones</strong>(airport_icao_array)  &#x21d2; <tt>Hash{String =&gt; TZInfo::DataTimezone}</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Looks up the timezones for multiple ICAO airport codes.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>airport_icao_array</span>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>ICAO airport codes</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash{String =&gt; TZInfo::DataTimezone}</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>ICAO keys and timezone values</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/modules/flight_xml.rb', line 63</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_airport_timezones'>airport_timezones</span><span class='lparen'>(</span><span class='id identifier rubyid_airport_icao_array'>airport_icao_array</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_airport_icao_array'>airport_icao_array</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_icao'>icao</span><span class='op'>|</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_icao'>icao</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_airport_timezone'>airport_timezone</span><span class='lparen'>(</span><span class='id identifier rubyid_icao'>icao</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_reduce'>reduce</span><span class='lparen'>(</span><span class='symbol'>:merge</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="client-class_method">
  
    .<strong>client</strong>  &#x21d2; <tt>Savon::Client</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Defines the Savon client to connect to the FlightXML API.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Savon::Client</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a Savon client</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


25
26
27</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/modules/flight_xml.rb', line 25</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_client'>client</span>
  <span class='kw'>return</span> <span class='const'>Savon</span><span class='period'>.</span><span class='id identifier rubyid_client'>client</span><span class='lparen'>(</span><span class='label'>wsdl:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https://flightxml.flightaware.com/soap/FlightXML2/wsdl</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>basic_auth:</span> <span class='lbracket'>[</span><span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_credentials'>credentials</span><span class='lbracket'>[</span><span class='symbol'>:flightaware</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:username</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_credentials'>credentials</span><span class='lbracket'>[</span><span class='symbol'>:flightaware</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:api_key</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="flight_lookup-class_method">
  
    .<strong>flight_lookup</strong>(ident)  &#x21d2; <tt>Array&lt;Hash&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Looks up flight data for flights matching a flight identifier string.</p>

<p>A flight identifier is a string containing an airline code and a flight
number, with no space between them (e.g. AA1234 or UAL5678). The airline
can be ICAO or IATA, but IATA codes that contain numbers (e.g. B6) may not
be used (the ICAO code must then be used in these cases).</p>

<p>Usually the multiple matching flights are the same flight number on
different days, but some airlines reuse a flight number multiple times per
day for different routes.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>ident</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a flight identifier</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Hash&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>data for each matching flight</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


80
81
82
83
84
85
86
87
88
89
90
91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/modules/flight_xml.rb', line 80</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_flight_lookup'>flight_lookup</span><span class='lparen'>(</span><span class='id identifier rubyid_ident'>ident</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
   
    <span class='id identifier rubyid_flights'>flights</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:flight_info_ex</span><span class='comma'>,</span> <span class='label'>message:</span> <span class='lbrace'>{</span>
      <span class='label'>ident:</span> <span class='id identifier rubyid_ident'>ident</span><span class='comma'>,</span>
      <span class='label'>how_many:</span> <span class='int'>15</span><span class='comma'>,</span>
      <span class='label'>offset:</span> <span class='int'>0</span>
      <span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span><span class='lbracket'>[</span><span class='symbol'>:flight_info_ex_results</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:flight_info_ex_result</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:flights</span><span class='rbracket'>]</span>
    
    <span class='kw'>return</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_wrap'>wrap</span><span class='lparen'>(</span><span class='id identifier rubyid_flights'>flights</span><span class='rparen'>)</span> <span class='comment'># Ensure result is an array even if it&#39;s a single flight
</span>  <span class='kw'>rescue</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="form_values-class_method">
  
    .<strong>form_values</strong>(fa_flight_id)  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Looks up flight data for a FlightXML fa_flight_id.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>fa_flight_id</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a FlightAware/FlightXML unique flight ID</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>flight data</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/modules/flight_xml.rb', line 99</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_form_values'>form_values</span><span class='lparen'>(</span><span class='id identifier rubyid_fa_flight_id'>fa_flight_id</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_fa_flight_id'>fa_flight_id</span>
  <span class='id identifier rubyid_fields'>fields</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_flight_info_ex'>flight_info_ex</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:flight_info_ex</span><span class='comma'>,</span> <span class='label'>message:</span> <span class='lbrace'>{</span>
      <span class='label'>ident:</span> <span class='id identifier rubyid_fa_flight_id'>fa_flight_id</span><span class='comma'>,</span>
      <span class='label'>how_many:</span> <span class='int'>1</span><span class='comma'>,</span>
      <span class='label'>offset:</span> <span class='int'>0</span>
      <span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span><span class='lbracket'>[</span><span class='symbol'>:flight_info_ex_results</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:flight_info_ex_result</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:flights</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_airline_flight_info'>airline_flight_info</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:airline_flight_info</span><span class='comma'>,</span> <span class='label'>message:</span> <span class='lbrace'>{</span>
      <span class='label'>fa_flight_i_d:</span> <span class='id identifier rubyid_fa_flight_id'>fa_flight_id</span>
      <span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span><span class='lbracket'>[</span><span class='symbol'>:airline_flight_info_results</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:airline_flight_info_result</span><span class='rbracket'>]</span>
  <span class='kw'>rescue</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
  
  <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='lparen'>(</span><span class='symbol'>:origin_airport_icao</span><span class='comma'>,</span> <span class='id identifier rubyid_flight_info_ex'>flight_info_ex</span><span class='lbracket'>[</span><span class='symbol'>:origin</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_flight_info_ex'>flight_info_ex</span><span class='lbracket'>[</span><span class='symbol'>:origin</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='lparen'>(</span><span class='symbol'>:destination_airport_icao</span><span class='comma'>,</span> <span class='id identifier rubyid_flight_info_ex'>flight_info_ex</span><span class='lbracket'>[</span><span class='symbol'>:destination</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_flight_info_ex'>flight_info_ex</span><span class='lbracket'>[</span><span class='symbol'>:destination</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='lparen'>(</span><span class='symbol'>:aircraft_family_icao</span><span class='comma'>,</span> <span class='id identifier rubyid_flight_info_ex'>flight_info_ex</span><span class='lbracket'>[</span><span class='symbol'>:aircrafttype</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_flight_info_ex'>flight_info_ex</span><span class='lbracket'>[</span><span class='symbol'>:aircrafttype</span><span class='rbracket'>]</span>
  
  <span class='id identifier rubyid_operator_icao'>operator_icao</span> <span class='op'>=</span> <span class='id identifier rubyid_flight_info_ex'>flight_info_ex</span><span class='lbracket'>[</span><span class='symbol'>:ident</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span><span class='int'>3</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_flight_info_ex'>flight_info_ex</span><span class='lbracket'>[</span><span class='symbol'>:ident</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='lparen'>(</span><span class='symbol'>:operator_icao</span><span class='comma'>,</span> <span class='id identifier rubyid_flight_info_ex'>flight_info_ex</span><span class='lbracket'>[</span><span class='symbol'>:ident</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span><span class='int'>3</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_operator_icao'>operator_icao</span>
  
  <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='lparen'>(</span><span class='symbol'>:departure_utc</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='id identifier rubyid_flight_info_ex'>flight_info_ex</span><span class='lbracket'>[</span><span class='symbol'>:filed_departuretime</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_utc'>utc</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_flight_info_ex'>flight_info_ex</span><span class='lbracket'>[</span><span class='symbol'>:filed_departuretime</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_store'>store</span><span class='lparen'>(</span><span class='symbol'>:tail_number</span><span class='comma'>,</span> <span class='id identifier rubyid_airline_flight_info'>airline_flight_info</span><span class='lbracket'>[</span><span class='symbol'>:tailnumber</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_airline_flight_info'>airline_flight_info</span><span class='lbracket'>[</span><span class='symbol'>:tailnumber</span><span class='rbracket'>]</span>
  
  <span class='kw'>return</span> <span class='id identifier rubyid_fields'>fields</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_flight_id-class_method">
  
    .<strong>get_flight_id</strong>(ident, departure_utc)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Looks up a FlightXML unique flight ID for flights matching a flight
identifier string and UTC departure date/time.</p>

<p>A flight identifier is a string containing an airline code and a flight
number, with no space between them (e.g. AA1234 or UAL5678). The airline
can be ICAO or IATA, but IATA codes that contain numbers (e.g. B6) may not
be used (the ICAO code must then be used in these cases).</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>ident</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a flight identifier</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>departure_utc</span>
      
      
        <span class='type'>(<tt>DateTime</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a UTC departure time</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a FlightXML fa_flight_id</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


142
143
144
145
146
147
148
149
150
151
152
153
154</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/modules/flight_xml.rb', line 142</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_flight_id'>get_flight_id</span><span class='lparen'>(</span><span class='id identifier rubyid_ident'>ident</span><span class='comma'>,</span> <span class='id identifier rubyid_departure_utc'>departure_utc</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_ident'>ident</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_departure_utc'>departure_utc</span>
  
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_flight_id'>flight_id</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='symbol'>:get_flight_id</span><span class='comma'>,</span> <span class='label'>message:</span> <span class='lbrace'>{</span>
      <span class='label'>ident:</span> <span class='id identifier rubyid_ident'>ident</span><span class='comma'>,</span>
      <span class='label'>departure_time:</span> <span class='id identifier rubyid_departure_utc'>departure_utc</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_flight_id'>flight_id</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span><span class='lbracket'>[</span><span class='symbol'>:get_flight_id_results</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:get_flight_id_result</span><span class='rbracket'>]</span>
  <span class='kw'>rescue</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Sep 25 20:12:29 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.19 (ruby-2.3.1).
</div>

    </div>
  </body>
</html>