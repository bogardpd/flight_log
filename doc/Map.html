<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Map
  
    &mdash; Documentation by YARD 0.9.19
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Map";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (M)</a> &raquo;
    
    
    <span class="title">Map</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Map
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Map</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd>ActionView::Context, ActionView::Helpers</dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/classes/map.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Defines a map of various combinations of <span class='object_link'><a href="Flight.html" title="Flight (class)">Flights</a></span> and <span class='object_link'><a href="Airport.html" title="Airport (class)">Airports</a></span>, with the ability to generate <a href="http://www.gcmap.com/" target="_parent" title="Great Circle Mapper">Great Circle Mapper</a>, <a href="https://www.topografix.com/gpx.asp" target="_parent" title="GPX">GPX</a>, and
<a href="https://developers.google.com/kml/" target="_parent" title="KML">KML</a> maps.</p>

<p>While Map can be used for class methods, instances of Map are not intended
to be used directly (which is why it specifies no constructor method).
Instead, the subclasses which provide specific map types should be used to
create new maps.</p>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="http://www.gcmap.com/" target="_parent" title="Great Circle Mapper">Great Circle Mapper</a></li>
    
      <li><a href="https://www.topografix.com/gpx.asp" target="_parent" title="GPX: the GPS Exchange Format">GPX: the GPS Exchange Format</a></li>
    
      <li><a href="https://www.topografix.com/gpx.asp" target="_parent" title="Keyhole Markup Language">Keyhole Markup Language</a></li>
    
  </ul>

</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="AirportFrequencyMap.html" title="AirportFrequencyMap (class)">AirportFrequencyMap</a></span>, <span class='object_link'><a href="AirportsMap.html" title="AirportsMap (class)">AirportsMap</a></span>, <span class='object_link'><a href="FlightsMap.html" title="FlightsMap (class)">FlightsMap</a></span>, <span class='object_link'><a href="HighlightedRoutesMap.html" title="HighlightedRoutesMap (class)">HighlightedRoutesMap</a></span>, <span class='object_link'><a href="SingleFlightMap.html" title="SingleFlightMap (class)">SingleFlightMap</a></span></p>
</div>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="ICAO_REGIONS-constant" class="">ICAO_REGIONS =
          <div class="docstring">
  <div class="discussion">
    
<p>Defines the preset regions and their ICAO code start characters for use in
creating region tabs for region-sensitive maps.</p>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#gcmap_regions-instance_method" title="Map#gcmap_regions (method)">#gcmap_regions</a></span></li>
    
  </ul>

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>World</span><span class='label_end'>&quot;:</span>            <span class='qwords_beg'>%w(</span><span class='words_sep'>)</span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>North America</span><span class='label_end'>&quot;:</span>    <span class='qwords_beg'>%w(</span><span class='tstring_content'>C</span><span class='words_sep'> </span><span class='tstring_content'>K</span><span class='words_sep'> </span><span class='tstring_content'>M</span><span class='words_sep'> </span><span class='tstring_content'>T</span><span class='words_sep'>)</span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Europe</span><span class='label_end'>&quot;:</span>           <span class='qwords_beg'>%w(</span><span class='tstring_content'>B</span><span class='words_sep'> </span><span class='tstring_content'>E</span><span class='words_sep'> </span><span class='tstring_content'>L</span><span class='words_sep'>)</span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Pacific/Oceania</span><span class='label_end'>&quot;:</span>  <span class='qwords_beg'>%w(</span><span class='tstring_content'>A</span><span class='words_sep'> </span><span class='tstring_content'>N</span><span class='words_sep'> </span><span class='tstring_content'>PH</span><span class='words_sep'> </span><span class='tstring_content'>R</span><span class='words_sep'> </span><span class='tstring_content'>Y</span><span class='words_sep'>)</span>
<span class='rbrace'>}</span></pre></dd>
      
        <dt id="XML_PROLOG-constant" class="">XML_PROLOG =
          <div class="docstring">
  <div class="discussion">
    
<p>The XML version and encoding for this application&#39;s XML files.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>%Q(</span><span class='tstring_content'>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><span class='tstring_end'>)</span></span><span class='period'>.</span><span class='id identifier rubyid_html_safe'>html_safe</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hash_image_query-class_method" title="hash_image_query (class method)">.<strong>hash_image_query</strong>(query)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a hash of a map query based on a secret key in the application
credentials.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gcmap-instance_method" title="#gcmap (instance method)">#<strong>gcmap</strong>  &#x21d2; ActiveSupport::SafeBuffer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates HTML for a <a href="http://www.gcmap.com/" target="_parent" title="Great Circle Mapper">Great Circle Mapper</a> map.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gcmap_exists%3F-instance_method" title="#gcmap_exists? (instance method)">#<strong>gcmap_exists?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks whether or not this map contains enough data to create a
<a href="http://www.gcmap.com/" target="_parent" title="Great Circle Mapper">Great Circle Mapper</a> map.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gcmap_regions-instance_method" title="#gcmap_regions (instance method)">#<strong>gcmap_regions</strong>(selected_region)  &#x21d2; Hash{String =&gt; Boolean, Array} </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns all regions contained in the current map.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gpx-instance_method" title="#gpx (instance method)">#<strong>gpx</strong>  &#x21d2; ActiveSupport::Safebuffer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates XML for a <a href="https://www.topografix.com/gpx.asp" target="_parent" title="GPX">GPX</a> map.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#kml-instance_method" title="#kml (instance method)">#<strong>kml</strong>  &#x21d2; ActiveSupport::Safebuffer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates XML for a <a href="https://developers.google.com/kml/" target="_parent" title="KML">KML</a> map.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  

  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="hash_image_query-class_method">
  
    .<strong>hash_image_query</strong>(query)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates a hash of a map query based on a secret key in the application
credentials.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>query</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the query to hash</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a hash of the query</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="PagesController.html#gcmap_image_proxy-instance_method" title="PagesController#gcmap_image_proxy (method)">PagesController#gcmap_image_proxy</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


144
145
146</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/classes/map.rb', line 144</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_hash_image_query'>hash_image_query</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>
  <span class='const'>Digest</span><span class='op'>::</span><span class='const'>MD5</span><span class='period'>.</span><span class='id identifier rubyid_hexdigest'>hexdigest</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span> <span class='op'>+</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_credentials'>credentials</span><span class='lbracket'>[</span><span class='symbol'>:image_key</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="gcmap-instance_method">
  
    #<strong>gcmap</strong>  &#x21d2; <tt>ActiveSupport::SafeBuffer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates HTML for a <a href="http://www.gcmap.com/" target="_parent" title="Great Circle Mapper">Great Circle Mapper</a> map.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>ActiveSupport::SafeBuffer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>HTML for a <a href="http://www.gcmap.com/" target="_parent" title="Great Circle Mapper">Great Circle Mapper</a> map.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="http://www.gcmap.com/" target="_parent" title="Great Circle Mapper">Great Circle Mapper</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


36
37
38
39
40
41</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/classes/map.rb', line 36</span>

<span class='kw'>def</span> <span class='id identifier rubyid_gcmap'>gcmap</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_content_tag'>content_tag</span><span class='lparen'>(</span><span class='symbol'>:div</span><span class='comma'>,</span> <span class='label'>class:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>center</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_link_to'>link_to</span><span class='lparen'>(</span><span class='id identifier rubyid_image_tag'>image_tag</span><span class='lparen'>(</span><span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_routes'>routes</span><span class='period'>.</span><span class='id identifier rubyid_url_helpers'>url_helpers</span><span class='period'>.</span><span class='id identifier rubyid_gcmap_image_path'>gcmap_image_path</span><span class='lparen'>(</span><span class='id identifier rubyid_gcmap_airport_options'>gcmap_airport_options</span><span class='comma'>,</span> <span class='id identifier rubyid_gcmap_query'>gcmap_query</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="Map (class)">Map</a></span></span><span class='period'>.</span><span class='id identifier rubyid_hash_image_query'><span class='object_link'><a href="#hash_image_query-class_method" title="Map.hash_image_query (method)">hash_image_query</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_gcmap_query'>gcmap_query</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>alt:</span> <span class='id identifier rubyid_map_description'>map_description</span><span class='comma'>,</span> <span class='label'>class:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>map</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://www.gcmap.com/mapui?PM=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gcmap_airport_options'>gcmap_airport_options</span><span class='embexpr_end'>}</span><span class='tstring_content'>&amp;MP=r&amp;MS=wls2&amp;P=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gcmap_query'>gcmap_query</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>target:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_blank</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_content_tag'>content_tag</span><span class='lparen'>(</span><span class='symbol'>:div</span><span class='comma'>,</span> <span class='const'>ActiveSupport</span><span class='op'>::</span><span class='const'>SafeBuffer</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Map generated by </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_link_to'>link_to</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Great Circle Mapper</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://www.gcmap.com/</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>target:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_blank</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>class:</span> <span class='qwords_beg'>%w(</span><span class='tstring_content'>credit</span><span class='words_sep'> </span><span class='tstring_content'>map-credit</span><span class='words_sep'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="gcmap_exists?-instance_method">
  
    #<strong>gcmap_exists?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks whether or not this map contains enough data to create a
<a href="http://www.gcmap.com/" target="_parent" title="Great Circle Mapper">Great Circle Mapper</a> map.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether or not this map has a non-blank <a href="http://www.gcmap.com/" target="_parent" title="Great Circle Mapper">Great Circle Mapper</a> querystring</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="http://www.gcmap.com/" target="_parent" title="Great Circle Mapper">Great Circle Mapper</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


49
50
51</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/classes/map.rb', line 49</span>

<span class='kw'>def</span> <span class='id identifier rubyid_gcmap_exists?'>gcmap_exists?</span>
  <span class='id identifier rubyid_gcmap_query'>gcmap_query</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="gcmap_regions-instance_method">
  
    #<strong>gcmap_regions</strong>(selected_region)  &#x21d2; <tt>Hash{String =&gt; Boolean, Array}</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns all regions contained in the current map. Used for generating
region selection tabs above a <a href="http://www.gcmap.com/" target="_parent" title="Great Circle Mapper">Great Circle Mapper</a>
map image.</p>

<p>Regions are defined by an array of ICAO code prefixes (e.g. [“K”,“PH”]).
<span class='object_link'><a href="Airport.html" title="Airport (class)">Airports</a></span> are considered to be in a region if their ICAO code
starts with any of the elements of the prefix array (e.g. KATL, PHNL), and
<span class='object_link'><a href="Flight.html" title="Flight (class)">Flights</a></span> are considered to be in a region if <em>both</em> of their
airports are in the region.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>selected_region</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an array of ICAO prefixes (e.g. [“K”,“PH”]).</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash{String =&gt; Boolean, Array}</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>name and ICAO prefixes for each region, and a boolean indicating whether
this region&#39;s button should be selected (true if this region is the
currently selected region) in the format {“Europe”: {selected: false,
icao: [“B”,“E”,“L”]}}</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#ICAO_REGIONS-constant" title="Map::ICAO_REGIONS (constant)">ICAO_REGIONS</a></span></li>
    
      <li><span class='object_link'><a href="ApplicationHelper.html#gcmap_with_region_select-instance_method" title="ApplicationHelper#gcmap_with_region_select (method)">ApplicationHelper#gcmap_with_region_select</a></span></li>
    
      <li><a href="http://www.gcmap.com/" target="_parent" title="Great Circle Mapper">Great Circle Mapper</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/classes/map.rb', line 71</span>

<span class='kw'>def</span> <span class='id identifier rubyid_gcmap_regions'>gcmap_regions</span><span class='lparen'>(</span><span class='id identifier rubyid_selected_region'>selected_region</span><span class='rparen'>)</span>
  <span class='ivar'>@airport_details</span> <span class='op'>||=</span> <span class='id identifier rubyid_airport_details'>airport_details</span>
  <span class='id identifier rubyid_used_airports'>used_airports</span> <span class='op'>=</span> <span class='ivar'>@airport_details</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span>
  <span class='id identifier rubyid_region_hash'>region_hash</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='const'><span class='object_link'><a href="#ICAO_REGIONS-constant" title="Map::ICAO_REGIONS (constant)">ICAO_REGIONS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_icao'>icao</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_selected_region'>selected_region</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span> <span class='op'>==</span> <span class='id identifier rubyid_icao'>icao</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span>
      <span class='id identifier rubyid_region_hash'>region_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='label'>selected:</span> <span class='kw'>true</span><span class='rbrace'>}</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_in_region'>in_region</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Airport.html" title="Airport (class)">Airport</a></span></span><span class='period'>.</span><span class='id identifier rubyid_in_region_ids'><span class='object_link'><a href="Airport.html#in_region_ids-class_method" title="Airport.in_region_ids (method)">in_region_ids</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_icao'>icao</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span>
      <span class='kw'>if</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_in_region'>in_region</span> <span class='op'>&amp;</span> <span class='id identifier rubyid_used_airports'>used_airports</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='id identifier rubyid_used_airports'>used_airports</span> <span class='op'>-</span> <span class='id identifier rubyid_in_region'>in_region</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_icao'>icao</span> <span class='op'>==</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
        <span class='comment'># This region has airports, but is not identical to world OR this region is world.
</span>        <span class='id identifier rubyid_region_hash'>region_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='label'>selected:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>icao:</span> <span class='id identifier rubyid_icao'>icao</span><span class='rbrace'>}</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_region_hash'>region_hash</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="gpx-instance_method">
  
    #<strong>gpx</strong>  &#x21d2; <tt>ActiveSupport::Safebuffer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates XML for a <a href="https://www.topografix.com/gpx.asp" target="_parent" title="GPX">GPX</a> map.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>ActiveSupport::Safebuffer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>XML for a <a href="https://www.topografix.com/gpx.asp" target="_parent" title="GPX">GPX</a> map.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://www.topografix.com/gpx.asp" target="_parent" title="GPX: the GPS Exchange Format">GPX: the GPS Exchange Format</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/classes/map.rb', line 96</span>

<span class='kw'>def</span> <span class='id identifier rubyid_gpx'>gpx</span>
  <span class='ivar'>@airport_details</span> <span class='op'>||=</span> <span class='id identifier rubyid_airport_details'>airport_details</span>
  <span class='id identifier rubyid_used_airports'>used_airports</span> <span class='op'>=</span> <span class='ivar'>@airport_details</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="#XML_PROLOG-constant" title="Map::XML_PROLOG (constant)">XML_PROLOG</a></span></span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>+=</span> <span class='id identifier rubyid_content_tag'>content_tag</span><span class='lparen'>(</span><span class='symbol'>:gpx</span><span class='comma'>,</span> <span class='label'>xmlns:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://www.topografix.com/GPX/1/1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>version:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1.1</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_concat'>concat</span> <span class='lparen'>(</span><span class='id identifier rubyid_content_tag'>content_tag</span><span class='lparen'>(</span><span class='symbol'>:metadata</span><span class='rparen'>)</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_content_tag'>content_tag</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='comma'>,</span> <span class='id identifier rubyid_map_name'>map_name</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_content_tag'>content_tag</span><span class='lparen'>(</span><span class='symbol'>:desc</span><span class='comma'>,</span> <span class='id identifier rubyid_map_description'>map_description</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_concat'>concat</span> <span class='lparen'>(</span><span class='id identifier rubyid_content_tag'>content_tag</span><span class='lparen'>(</span><span class='symbol'>:author</span><span class='rparen'>)</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_content_tag'>content_tag</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Paul Bogard’s Flight Historian</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_content_tag'>content_tag</span><span class='lparen'>(</span><span class='symbol'>:link</span><span class='comma'>,</span> <span class='id identifier rubyid_content_tag'>content_tag</span><span class='lparen'>(</span><span class='symbol'>:text</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Paul Bogard’s Flight Historian</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>href:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https://www.flighthistorian.com</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span><span class='rparen'>)</span>
    <span class='kw'>end</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_gpx_airports'>gpx_airports</span><span class='lparen'>(</span><span class='id identifier rubyid_used_airports'>used_airports</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_gpx_routes'>gpx_routes</span><span class='lparen'>(</span><span class='id identifier rubyid_routes_normal'>routes_normal</span> <span class='op'>|</span> <span class='id identifier rubyid_routes_out_of_region'>routes_out_of_region</span> <span class='op'>|</span> <span class='id identifier rubyid_routes_highlighted'>routes_highlighted</span> <span class='op'>|</span> <span class='id identifier rubyid_routes_unhighlighted'>routes_unhighlighted</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_output'>output</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="kml-instance_method">
  
    #<strong>kml</strong>  &#x21d2; <tt>ActiveSupport::Safebuffer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates XML for a <a href="https://developers.google.com/kml/" target="_parent" title="KML">KML</a> map.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>ActiveSupport::Safebuffer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>XML for a <a href="https://developers.google.com/kml/" target="_parent" title="KML">KML</a> map.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://www.topografix.com/gpx.asp" target="_parent" title="Keyhole Markup Language">Keyhole Markup Language</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/classes/map.rb', line 120</span>

<span class='kw'>def</span> <span class='id identifier rubyid_kml'>kml</span>
  <span class='ivar'>@airport_details</span> <span class='op'>||=</span> <span class='id identifier rubyid_airport_details'>airport_details</span>
  <span class='id identifier rubyid_used_airports'>used_airports</span> <span class='op'>=</span> <span class='ivar'>@airport_details</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="#XML_PROLOG-constant" title="Map::XML_PROLOG (constant)">XML_PROLOG</a></span></span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>+=</span> <span class='id identifier rubyid_content_tag'>content_tag</span><span class='lparen'>(</span><span class='symbol'>:kml</span><span class='comma'>,</span> <span class='label'>xmlns:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://www.opengis.net/kml/2.2</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_content_tag'>content_tag</span><span class='lparen'>(</span><span class='symbol'>:Document</span><span class='rparen'>)</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_content_tag'>content_tag</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='comma'>,</span> <span class='id identifier rubyid_map_name'>map_name</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_content_tag'>content_tag</span><span class='lparen'>(</span><span class='symbol'>:description</span><span class='comma'>,</span> <span class='id identifier rubyid_map_description'>map_description</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_kml_styles'>kml_styles</span>
      <span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_kml_airports'>kml_airports</span><span class='lparen'>(</span><span class='id identifier rubyid_used_airports'>used_airports</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_kml_routes'>kml_routes</span><span class='lparen'>(</span><span class='id identifier rubyid_routes_normal'>routes_normal</span> <span class='op'>|</span> <span class='id identifier rubyid_routes_out_of_region'>routes_out_of_region</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Routes</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_kml_routes'>kml_routes</span><span class='lparen'>(</span><span class='id identifier rubyid_routes_highlighted'>routes_highlighted</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Highlighted Routes</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_kml_routes'>kml_routes</span><span class='lparen'>(</span><span class='id identifier rubyid_routes_unhighlighted'>routes_unhighlighted</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unhighlighted Routes</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_output'>output</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sun Sep 22 13:00:04 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.19 (ruby-2.3.1).
</div>

    </div>
  </body>
</html>