<h1>Airports</h1>

<% if @flights.any? %>

	<div class="page_navigation">
	  <ul>
			<li><%= link_to("Airport Map", "#airport-map", :title => "Airports Map") %></li>
			<li><%= link_to("List of Airports", "#airports-list", :title => "List of Airports") %></li>
			<li><%= link_to("Airport Frequency Map", "#airport-frequency-map", :title => "Airport Frequency Map") %></li>
	  </ul>
	</div>

<% end %>

<p>I have visited <%= pluralize(@airports.count || 0, "airport") %>.</p>

<% if @flights.any? %>

	<div id="airport-map">
    <%= map_with_region_select(@airports_map, anchor: "airports-map") %>
  </div>

	<div id="airports-list">

  	<p class="center">A layover counts as one single visit to a given airport, even though two flights use it.</p>

    <%= render partial: "airport_count_table", locals: {airports: @airports, is_summary: false} %>

  	<% if (logged_in? && @airports_with_no_flights.any?) %>
    	<h2>Airports with No Flights</h2>
    	<table class="flightlog">
    	<% @airports_with_no_flights.each do |airport| %>
    	  <tr>
    	    <td class="airport_city"><%= image_tag(Airport.new(:country => airport[:country]).country_flag_path, :title => airport[:country], :class => "country_flag") %> <%= link_to(airport.city, airport_path(airport[:iata_code]), :title => "View airport details for #{airport.city}") %></td>
    	    <td class="airport-code code-mono"><%= link_to(airport.iata_code, airport_path(airport[:iata_code]), :title => "View airport details for #{airport.city}") %></td>

    	  </tr>
    	<% end %>
    	</table>
    <% end %>
  </div>

	<h2 id="airport-frequency-map">Airport Frequency Map</h2>

	<p>This map shows how often Iʼve visited each airport. The area of the black rings centered on each red airport represents the number of times Iʼve visited that airport.</p>

  <%= map_with_region_select(@frequency_map, anchor: "frequency-map") %>

<% else %>

	<%= render "flights/error_no_flights" %>

<% end %>