<h1>Airlines</h1>

<div class="page_navigation">
  <ul>
		<li><%= link_to("Airlines", "#airlines", :title => "Airlines") %></li>
		<li><%= link_to("Operators", "#operators", :title => "Operators") %></li>
  </ul>
</div>

<a name="airlines"></a>

<p>I have flown on <%= pluralize(@airlines_array.count, 'airline') %>.</p>

<% if @flight_airlines.empty? %>
	<% if (logged_in? && !Flight.any?) || (!logged_in? && Flight.visitor.empty?) %>
		<%= render 'error_no_flights' %>
	<% else %>
		<div class="alert">There are no flights in the flight log that include an airline!</p>
	<% end %>
<% else %>

<table class="flightlog">
  <tr class="th">
    <th class="counter">#</th>
		<th class="airline_airline"><%= sort_link("Airline", :airline, "airline", :asc, "airlines") %></th>
		<th class="airline_iata_code"><%= sort_link("Code", :iata, "code", :asc, "code") %></th>
    <th class="airline_flights"><%= sort_link("Flights", :flights, "flights", :desc, "airlines") %></th>
  </tr>
<% previous_count = nil %>
<% @airlines_array.each_with_index do |airline, index| %>
  <tr>
		<td class="counter"><%= (@sort_cat == :flights && airline[:count] == previous_count) ? "â‹®" : index + 1 %></td>
    <td class="airline_airline">
    	<%= link_to(image_tag(airline_icon_path(@airline_iata_codes[airline[:airline]]), :title => @airline_names[airline[:airline]], :class => 'airline_icon') + ' ' + @airline_names[airline[:airline]], airline_path(@airline_iata_codes[airline[:airline]])) %>
		</td>
		<td class="airline_iata_code iata_mono"><%= link_to(iata_airline_code_display(@airline_iata_codes[airline[:airline]]), airline_path(@airline_iata_codes[airline[:airline]])) %></td>
    <td class="airline_flights"><%= render "flights/graph_block", :value => airline[:count], :maximum => @airlines_maximum %></td>
  </tr>
	<% previous_count = airline[:count] %>
<% end %>
  <tr><td colspan="4" class="flightlog_total"><%= pluralize(@airlines_array.count, 'airline') %></td></tr>
</table>

<% end %>

<a name="operators"></a>
<h2>Operators</h2>




<% if (logged_in? && @airlines_with_no_flights.any?) %>
	<h2>Airlines with No Flights</h2>
	<table class="flightlog">
		<tr class="th">
			<th class="airline_airline">Airline</th>
			<th class="airline_iata_code">Code</th>
		</tr>
	<% @airlines_with_no_flights.each do |airline| %>
	  <tr>
	    <td class="airline_airline"><%= image_tag(airline_icon_path(airline.iata_airline_code), :title => airline.airline_name, :class => 'airline_icon')%> <%= link_to(airline.airline_name, airline_path(airline.iata_airline_code), :title => "View airline details for #{airline.airline_name}") %></td>
	    <td class="airline_iata_code iata_mono"><%= link_to(iata_airline_code_display(airline.iata_airline_code), airline_path(airline.iata_airline_code), :title => "View airport details for #{airline.airline_name}") %></td>
		</tr>
	<% end %>
	</table>
<% end %>
		
<% content_for :admin_actions do %>
  <%= link_to("Add New Airline", new_airline_path) %>
<% end %>